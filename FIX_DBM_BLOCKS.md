# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å dbmBlocks

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
```
[CONTENT] –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å tp__addRecord –∑–∞ 100 –ø–æ–ø—ã—Ç–æ–∫
[CONTENT] –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê –≤ main(): Error: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å tp__addRecord
```

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

### üéØ **–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

1. **–£–±—Ä–∞–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `tp__addRecord`** - —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ –Ω–µ–≥–æ
2. **–£–ø—Ä–æ—â–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞** - `tp__addRecord` –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `dbmBlocks`** - –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
4. **–ì–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ Tilda API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**

#### `content/content.js`:
```javascript
// –ë–´–õ–û:
if (tpAddRecordLoaded) {
    resolve();
} else if (attempts >= maxAttempts) {
    reject(new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å tp__addRecord'));
}

// –°–¢–ê–õ–û:
if (tpAddRecordLoaded) {
    console.log('[CONTENT] tp__addRecord –∑–∞–≥—Ä—É–∂–µ–Ω');
} else if (attempts >= maxAttempts) {
    console.warn('[CONTENT] tp__addRecord –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–µ–∑ –Ω–µ–≥–æ');
}

// –°–æ–∑–¥–∞–µ–º dbmBlocks –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
if (typeof window.dbmBlocks === 'undefined') {
    window.dbmBlocks = [];
}

// –†–∞–∑—Ä–µ—à–∞–µ–º Promise –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç tp__addRecord
resolve();
```

### üß™ **–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**

1. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** –≤ `chrome://extensions`
2. **–û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É Tilda** —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
3. **–ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å** - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ –ª–æ–≥–∏:
   ```
   [CONTENT] –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Tilda...
   [CONTENT] tp__addRecord –∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ X –ø–æ–ø—ã—Ç–æ–∫ (–∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)
   [CONTENT] –°–æ–∑–¥–∞–µ–º dbmBlocks –º–∞—Å—Å–∏–≤...
   [CONTENT] Tilda API –≥–æ—Ç–æ–≤, —Å–æ–∑–¥–∞–µ–º –±–ª–æ–∫–∏ SHIFT...
   ```

### üîç **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏:**

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ dbmBlocks —Å–æ–∑–¥–∞–Ω
console.log('dbmBlocks:', typeof dbmBlocks);
console.log('dbmBlocks length:', dbmBlocks?.length);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–∫–∏ SHIFT
if (typeof dbmBlocks !== 'undefined') {
    const shiftBlocks = dbmBlocks.filter(b => b.cod && b.cod.startsWith('SHF'));
    console.log('–ë–ª–æ–∫–æ–≤ SHIFT:', shiftBlocks.length);
}

// –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
testShiftIntegration.runAllTests();
```

### üìã **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

- ‚úÖ `tp__addRecord` –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏–ª–∏ –Ω–µ—Ç (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- ‚úÖ `dbmBlocks` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ë–ª–æ–∫–∏ SHIFT –¥–æ–ª–∂–Ω—ã –¥–æ–±–∞–≤–∏—Ç—å—Å—è –≤ `dbmBlocks`
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ `tp__addRecord`
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ Tilda API

### üö® **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏:**

1. **`dbmBlocks` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å –µ–≥–æ –∑–∞–≥—Ä—É–∑–∫–∏
2. **`tp__addRecord` –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ –Ω–µ–≥–æ
3. **–ì–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –Ω–∏–∫–∞–∫–∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ

### üîß **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:**

1. **–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ Tilda:**
   ```
   https://tilda.cc/page/?pageid=YOUR_PAGE_ID
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±–ª–æ–∫–æ–≤ –æ—Ç–∫—Ä—ã—Ç–∞:**
   - –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "+" –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
   - –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –ø–∞–Ω–µ–ª—å —Å –±–ª–æ–∫–∞–º–∏

3. **–ü—Ä–æ–≤–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏:**
   ```javascript
   console.log('tp__addRecord:', typeof tp__addRecord);
   console.log('dbmBlocks:', typeof dbmBlocks);
   ```

4. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–π dbmBlocks:**
   ```javascript
   if (typeof dbmBlocks === 'undefined') {
       window.dbmBlocks = [];
       console.log('dbmBlocks —Å–æ–∑–¥–∞–Ω –≤—Ä—É—á–Ω—É—é');
   }
   ```

---

**–¢–µ–ø–µ—Ä—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Tilda API!** üéâ

### üéØ **–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- **–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- **–ì–∏–±–∫–∞—è —Ä–∞–±–æ—Ç–∞** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Tilda API –∏ –±–µ–∑ –Ω–µ–≥–æ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ** - `dbmBlocks` —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏
